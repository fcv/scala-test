tutorial from http://www.scala-lang.org/node/242